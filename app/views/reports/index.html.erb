<% content_for :header_title, "Painel de Administração" %>
<% content_for :header_desc, "Gestão e monitoramento de relatos recebidos." %>

<article class="card">
  <header class="card__header card__header--split">
    <h2 class="card__title">Relatos Recebidos</h2>
    <%= link_to "Novo Relato", new_report_path, class: "button button--primary" %>
  </header>

  <div class="card__table-wrapper">
    <table class="data-table">
      <thead>
        <tr>
          <th>Protocolo</th>
          <th>Categoria</th>
          <th>Status</th>
          <th class="text-right">Ações</th>
        </tr>
      </thead>
<tbody>
  <% @reports.each do |report| %>
    <tr>
      <td><strong><%= report.protocolo %></strong></td>
      <td><%= report.categoria %></td>

      <td>
        <%= form_with url: update_status_report_path(report), method: :patch, class: "inline-form" do |f| %>
          <%= f.select :status, 
              Report.statuses.keys.map { |s| [s.humanize, s] }, 
              { selected: report.status }, 
              { 
                class: "badge badge--#{report.status}", 
                onchange: "this.form.requestSubmit()",
                style: "cursor: pointer; border: none; font-family: inherit; appearance: none; -webkit-appearance: none;" 
              } %>
        <% end %>
      </td>

      <td class="text-right">
        <div class="action-group">
          <%= link_to "Editar", edit_report_path(report), class: "link-action" %>
        </div>
      </td>
    </tr>
  <% end %>
</tbody>
    </table>
  </div>
</article>